<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us">
<head>
<title>jCarousel Examples</title>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.5.0/jquery.min.js" type="text/javascript" charset="utf-8"></script>
<script type="text/javascript" src="javascripts/lib/jquery.jcarousel.min.js"></script> 
<link rel="stylesheet" type="text/css" href="stylesheets/a7agg.css" /> 
<link rel="stylesheet" type="text/css" href="stylesheets/skin.css" /> 
 
<script type="text/javascript"> 
 
var a = [
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' }
];
 
var b = [
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/57/199481087_33ae73a8de_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' },
  { type: 'twitter', imgSrc: 'http://static.flickr.com/75/199481072_b4a0d09597_s.jpg', imgTitle: 'An image', linkURL: 'http://google.com', content: 'Lorem ipsum dolizzle doggy amet, consectetizzle adipiscing elit. Mah nizzle sapizzle velizzle, sure volutpizzle, suscipizzle quis, graviâ€¦', timestamp: 'UNIX' }
];
 
var JCarousel = JCarousel || {};
 
//Protect this
JCarousel.self = null;
JCarousel.currentFilter = null;
JCarousel.animationSpeed = 200;
 
JCarousel.utils = {
 
  populateCarousel: function (params) {
 
    for (var i = 0; i < params.objList.length; i++) {
      this.addItem({
          'objListIndex': i,  
          'objList': params.objList, 
          'carouselIndex':( params.additive ? JCarousel.self.options.size + i : i + 1 )
      });
    }
 
    //Update carousel size
    JCarousel.self.options.size +=  i;
    console.log(JCarousel.self.options.size);
  },
 
  addItem: function (params) {
    var currentItemObject = params.objList[params.objListIndex],
        currentListItem = JCarousel.self.add( params.carouselIndex, this.getItemHTML( currentItemObject ));
 
    return currentListItem;
  },
 
  getItemHTML: function (item) {
    var img = item.imgSrc, 
        html = '<div>';
    
    html += (img) ?'<a href="' + item.linkURL + '" title="' + item.imgTitle + '" class="item-image-link"><img src="' + item.imgSrc + '" width="50" height="50" alt="' + item.imgTitle + '" /></a>' : '';   
    html += '<div><p>' + item.content + '<a href="' + item.linkURL + '" title="Read More">More</a></p></div>';
    html += '</div>';
 
    return html;
  },
 
  getStagedItems: function () {
    var firstIndex = JCarousel.self.first,
        scrollInt = JCarousel.self.options.scroll,
        stagedItems = [];
 
      for (var i = firstIndex; i < firstIndex + scrollInt; i++) {
        stagedItems.push(JCarousel.self.get(i)[0]);
      }
 
      return stagedItems;
  },
 
  transitionNewItems: function (params) {
    jQuery(this.getStagedItems()).each(function (i){
 
      //Account for 0 based loop, when indexing for jcarousel - which starts at 1
      i+=1;
 
      jQuery('div:first', this)
        .css(params.css)
        .animate(
            params.animation, 
            JCarousel.animationSpeed * i, 
            (function (itemIndex) { 
              if (params.callback) { 
                return function () { params.callback(itemIndex); } 
              }
            })(i)
        );
    });
  },
 
  reloadCarousel: function (filteredJSON) {
    JCarousel.self.reset();
 
    JCarousel.self.options.size = 0; 
 
    JCarousel.utils.populateCarousel({
      'filter': true,
      'objList': filteredJSON 
    });
 
    JCarousel.utils.transitionNewItems({
      'css': {'position': 'relative', 'top': -jQuery(JCarousel.self.get(1)).height() - 10, 'opacity': 0},
      'animation': {'top': 0, 'opacity': 1}
    });
 
  },
 
  lockCarousel: function (b) { 
  },
 
  getJSON: function (params) {
     var filteredJSON, 
         self = this;
 
    //Double click
    if(jQuery(params.filterElm).hasClass('current') && !params.additive) {
      return false;
    }
 
    //Started again when content reloaded
    if (!params.additive) {
      JCarousel.self.pauseAuto(); 
    }
 
    this.lockCarousel(true);
 
    jQuery.ajax('json', {
 
      'cache': false,
 
      'dataType': 'json',
 
      'error': function (jqXHR, textStatus, errorThrown) {
 
      },
 
      'success': function (data, textStatus, jqXHR) {
        self.lockCarousel(false);
        params.callback(data);
 
      },
 
      'timeout': 5000
 
    });
 
  }
 
 
};
 
JCarousel.filters = {
 
  init: function (filterContainer) {
 
      JCarousel.currentFilter = jQuery('.current', filterContainer)[0];
 
      //Cosmetic initializaiton of select all filter on parent li
      jQuery(JCarousel.currentFilter).parent().width(10);
 
      jQuery('.showAllFilter, .twitterFilter, .youtubeFilter, .flickrFilter, .blogFilter', filterContainer).click(function ()  {
 
          var self = this;
 
          JCarousel.utils.getJSON({
            'filterElm': this, 
 
            'callback': function (filteredJSON) {
 
              JCarousel.utils.transitionNewItems({
                'css': {'position': 'relative'},
                'animation': {'top': 200},
                'callback': function (itemIndex) {
                    if (itemIndex === 1) {
                      JCarousel.utils.reloadCarousel(filteredJSON);
                    }
                }            
              });
 
              JCarousel.filters.collapseNav(self);
            }
          });
      
      });
 
  },
 
  collapseNav: function (filterElm) {
 
      var showAllFilter = jQuery(filterElm).parents('ul').find('a:first'),
          allTypeFiltersButSelf = jQuery(filterElm).parent().siblings().not(':first').find('a'),
          allFilters = jQuery(filterElm).parent().siblings().find('a'),
          showAllWidth = showAllFilter[0] === filterElm ? 10 : 128,
          allButShowAllWidth = showAllFilter[0] === filterElm ? 128 : 0;
 
      allFilters.removeClass('current');
      jQuery(filterElm).addClass('current');
      allTypeFiltersButSelf.parent().animate({'width': allButShowAllWidth});
      showAllFilter.parent().animate({'width': showAllWidth});
 
      JCarousel.currentFilter = filterElm; 
 
  }
};
 
 
jQuery(document).ready(function() {
    jQuery('#feedCarousel').jcarousel({
        auto: 10,
 
        //Init size
        size: 0,
 
        animation: 'slow',
 
        itemLastInCallback: function (carousel, currListElm, index, state) {

          if (index + carousel.options.scroll >= carousel.options.size ) {
            //Only add new if we have them - switch to check if we need to load items
            JCarousel.utils.getJSON({
              'filterElm': JCarousel.currentFilter, 
              'callback': function (filteredJSON) {
                  JCarousel.utils.populateCarousel({
                    'additive': true,
                    'objList': filteredJSON 
                  });
              }, 
              'additive': true
            });
          }
        },
 
        initCallback: function (carousel, state) { 
          if (state === 'init') {
            JCarousel.self =  carousel;
 
            JCarousel.utils.populateCarousel({ 'objList': a });
 
            JCarousel.filters.init(); 
          }
        }
    });
});

</script>
</head>
<body>
<div id="feedCarouselContainer">
    <ul id="navFilter">
      <li><a href="#" class="showAllFilter current">Show All</a></li>
      <li><a href="#" class="youtubeFilter">YouTube</a></li>
      <li><a href="#" class="blogFilter">Blog Posts</a></li>
      <li><a href="#" class="twitterFilter">Twitter</a></li>
      <li><a href="#" class="flickrFilter">Flickr</a></li>
    </ul>
    <ul id="feedCarousel" class="jcarousel-skin-feed">
      <!-- The content will be dynamically loaded in here -->
    </ul>
</div>
</body>
</html>

